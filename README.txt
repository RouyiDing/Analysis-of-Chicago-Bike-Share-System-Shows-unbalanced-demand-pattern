1.	Introduction
Biking is beneficial to both of our health and environment. Many cities have launched public bike-sharing system to promote bicycle usage. In bike-sharing systems, people can borrow bikes from one station and return the bike back to any stations in the city, which can be used as a short-distance trip supplement for private vehicles as well as regular public transportation. Divvy program in Chicago is one of the mature systems that we would like to explore.

In bike-share system, the travel behaviors of people in different age and gender groups can be quite different. Meanwhile, for stations located at different places in the city, the bike usage can be quite skewed and unbalanced. Some stations that individuals like to borrow bikes from will lack enough bikes for people to check out, while some other stations that people normally return the bikes to will get jammed easily without enough docks for upcoming bikes. Therefore, we want to discover different usage patterns among various user groups and time periods, as well as flow patterns of stations.

The bicycle sharing system in Chicago can be separated into 4 segments according to flow patterns. In these four segments, the flow patterns of transition and business areas are opposite and obviously unbalanced. This unbalanced pattern is caused by commuters.

2.	Method
2.1	Data Source
We investigated the dynamic bike flow patterns and customer types of bike sharing system in Chicago from January 2015 to December 2015. Divvy was launched in late June 2013. The system had 474 stations and 8274 bikes in 2015, and increased to 535 stations and 9214 bikes in 2016, which greatly improved its coverage and maximum working load. All bikes are available 24 hours, each station has a touch screen kiosk and docking system which support bikes check-in and check-out using a member key or ride code. Bike-sharing system allows people to borrow bikes with either “24-hour pass” or “annual subscribed membership”. “24-hour pass” is usually preferred by people for temporary usage, such as tourists and occasional riders, but charges per day are slightly higher. Meanwhile, “annual subscribed membership” is a great deal for people with frequent travel needs, such as local office workers and students.

The data we used in this project was obtained from Divvy website. (https://www.divvybikes.com) The datasets include trip, station and customer type information from January 2015 to December 2015. Trip dataset has 3183439 observations described by trip ID, start time and station, stop time and station and trip duration. Station dataset consists of station name, dock capacity, coordinates and created time. As for customer type, it is correlated with each trip and includes information about gender, age and user type.

2.2 Data Cleaning
Since the raw data we downloaded from Divvy website is already pretty tidy, our data cleaning is completed in only three steps. Firstly, we filtered and deleted trips with duration less than 1 minute, because these trips are too short and may not show a common use rule of the bike-sharing system. As a result, about 3.76 percent of trips were deleted. Secondly, in order to achieve standard data formats and make further statistical analysis easier, we transferred data to numeric type and unified the time format. Thirdly, we generated more variables, such as the date, time, exact hour and weekday variables from the original start time and stop time.

Since the raw data we downloaded from Divvy website is already pretty tidy, our data cleaning is completed in only three steps. Firstly, we filtered and deleted trips with duration less than 1 minute, because these trips are too short and may not show a common use rule of the bike-sharing system. As a result, about 3.76 percent of trips were deleted. Secondly, in order to achieve standard data formats and make further statistical analysis easier, we transferred data to numeric type and unified the time format. Thirdly, we generated more variables, such as the date, time, exact hour and weekday variables from the original start time and stop time.

2.3 Statistical Techniques
To investigate how flow patterns vary among stations, we first summarized demand features, namely, the amount of net check-in of each station, and then grouped stations with similar demand features. In this way, we could find out spatiotemporal over-demands distribution for bikes and docks in 2015 and further analyze the reasons for unbalance.

Specifically, the first step was to define the demand features for stations, we first divided a day into 12 2-hour time windows starting from 1:00am. Then for each station, we calculated the net check-in amount which was given by difference between total check-in amount and total check-out amount in each time window.

The second step was to group stations with similar demand features into same cluster. According to previous study, methods like K-means and hierarchical clustering are often used. Here we applied the hierarchical clustering method. Grouping the stations was an unsupervised problem without a true response and in hierarchical clustering, we could choose how many clusters we should have according to the dendrogram, while in K-Means method we need to set number of clusters K first, of which we didn't have any prior knowledge.

In hierarchical clustering, we got a distance matrix from R function `dist()` to evaluate the dissimilarity of stations according to 12 net check-ins. A dendrogram was built by this distance matrix using `hclust()`. This dendrogram was an upside-down tree starting from treating each station as one cluster and then fusing the most similar clusters until all stations belong to one single cluster. According to the shape of the tree, we cut the dendrogram at a reasonable height, which resulted in 4 clusters. `cutree()` gave us the final clusters of stations. Here we chose manhattan distance in `dist()` to calculate dissimilarities between stations and complete linkage in `hclust()` to define dissimilarities between clusters.
